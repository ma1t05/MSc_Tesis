\section{Description of Components}
The components of Scatter Search template \cite{glover1998template}
consists of
specific subroutines of the following types:
\begin{itemize}
\item A Diversification Generator
\item An Improvement Method
\item A Reference Set Update Method
\item A Subset Generation Method
\end{itemize}
We described below
each of the components.

\subsection{A Diversification Generator}
To component is used to generate
a collection of diverse trial solutions,
using an arbitrary trial solution
(or seed solution) as an input.
%\input{HeuristicProcedures/alg_ss-init}
In this research
we develop a Greedy Randomized Adaptive Search Procedure (GRASP)
as a diversification generator.
GRASP \cite{feo1995greedy}
is a multi-start procedure that combines
the power of greedy heuristics and randomization.

GRASP typically consists of two phases:
a greedy randomized construction phase
and an improvement phase.
In this case,
our proposed GRASP
consist only of the construction phase
because the improvement phase
is applied in other parts
of the scatter search algorithm.
\input{HeuristicProcedures/GRASP}

\subsection{An Improvement Method}
The propose of the improvement method
is to attempt to improve the quality
of a given previously found solution.
To transform a trial solution
into one or more
enhanced trial solutions.
(If no improvement
of the input trial solution results, 
the ``enhanced'' solution
is considered to be
\todo{Add reference to procedure 2}
the same as the input solution.)

Two improvement methods are developed.
The first is an adaptation
of the method proposed by Berman et al. \cite{berman1987stochastic}
(see Appendix \ref{ch:Berman} for mode details)
and the second
is a local search procedure
described next.
%\todo[inline]{Incluir descripcion del metodo de Berman}
\input{HeuristicProcedures/LocalSearch}

\subsection{A Reference Set Update Method}
A two-tier Reference Set
is chosen to maintain both
a pool of good quality solutions
and a pool of diverse solutions.
Each tier has size \textit{b},
where \textit{b}
is typically between 20 and 40.
In addition,
%And we opt for be dynamic
%since the number
%of generated solutions
%is big (proportional to \textit{p}).
since the number of generated solutions
is relatively large,
the Reference Set is dynamically updated.

The Reference Set is update
by trying to incorporate new solutions
generated by the combination method.
%\todo{No se entiende!}
%the update method
%first try to incorporate the solutions
%by quality criteria;
Because the Reference Set is divided
in two parts,
a new trial solution
is first tested by the quality criterion.
If this trial solution
is better
than any of the solutions
in the quality tier subset
of the Reference Set,
the new solution enters the Reference Set
and the worst solution
is removed from it.
These steps are shown in Algorithm \ref{alg:rs_update}.
\input{HeuristicProcedures/alg_RefSetUpdate}

If the new solution
does not enter the Reference Set by quality
or if a solution is removed
from the quality-tier subset,
then this solution is tested
based on the diversity criterion.
If this trial solution
has a better diversity value than any of the solutions
in the diversity-tier subset,
it enters the subset and the worst solution
(from the diversity standpoint)
is removed from the subset.
Note that every time
the quality-tier subset is re-evaluated
since the value of the diversity-based solutions
depends on the quality-set subset.
As shown by the Algorithm \ref{alg:rs_updatediv}.
\input{HeuristicProcedures/alg_RefSetUpdateDiversity}

\subsection{A Subset Generation Method}
The subset generation method
operates on the Reference Set
and its main role is
for creating combined solutions.
\input{HeuristicProcedures/alg_SubsetGeneration}
In this particular case,
we only look for subsets of size two,
that is,
pairs of solutions,
because our Reference Set is dynamic.
To identify the new solutions,
we label the solutions as new and old
at the start of each iteration.
We combine first
the new solutions between them,
next
the new solutions with the old.
The new solutions that enters in the Reference Set
as a combined solution
is not part of the subsets
until the next iteration.
Each solution generated
that did not enter the Reference Set,
displaced by a better solution,
or actually
a member of the diverse part of the Refemce Set,
is evaluated to be in the Reference Set
as a diverse solution.

\subsection{A Solution Combination Method}
The goal of the combination method,
in general,
is to transform a given subset of solutions
produced by the subset generation method
into one or more combined solutions.
In this particular case,
the proposed combination method
takes two differently solutions,
say $X^1$ and $X^2$ as input
and apply a path relinking procedure
between these two solutions
to generate a path of different solutions
between $X^1$ and $X^2$.
Path relinking [CITA1] \todo{Fred Glover, Manuel Laguna and Rafael Marti. Fundamentals of scatter search and path relinking.  Control and Cybernetics, 29(3):653-684 2000.}
has been very successful
in many combinatorial optimization problems
including some location related problems
such as the $p$-median problem [CITA2] \todo{M.G.C. Resende and R.F. Werneck. A hybrid heuristic for the p-median problem. J. of Heuristics, 10(1):59–88, 2004.}
and commercial districting [CITA3], to name a few. \todo{R.Z. Ríos-Mercado and H.J. Escalante.
GRASP with path relinking for commercial districting.
Expert Systems with Applications,
44:102-113, 2016}

Since each solution is in fact driven or represented
by the location of the adjusters (or servers),
to do the path relinking between any two solutions
we must first find a match between servers
form one solution to servers of the other solution.
According to these,
we test the following three different strategies
for finding this matching.

We choose a path relinking as a combination method
consisting of
determining a match between servers,
this match can be
\begin{itemize}
\item Perfect Matching:
  Pair the servers by the corresponding perfect matching problem,
  that is,
  by minimizing the distance between paired servers.
\item Workload Matching:
  The servers in each solution
  are sorted according to their workloads
  (from highest to lowest),
  and then
  match them according to these sorted lists
  (e.g.,
  server with highest workload in solution 1
  with server with highest load in solution 2
  and so on).
\item Random Matching
\end{itemize}
Once the server matching is found,
we proceed to generate the path
from solution to the other
by exchanging one server at a time.
Each move generates one new solution in the path.
There are different critera
for choosing the order of the exchanges.
The following three strategies are tested.
\begin{itemize}
\item Nearest First:
  Perform the exchange
  from nearest to farthest,
  that is,
  start exchanging the servers
  whose paired distance
  is the lowest.
\item Farthest First:
  Perform the exchange from farthest to nearest,
  that is,
  exchanging the servers
  whose paired distance
  is the highest.
\item Random
\end{itemize}
\input{HeuristicProcedures/alg_ss-combination}
All these different strategies
pose in algorithm \ref{alg:pr_combination}
are tested and assessed
in the following chapter.
%\todo[inline]{Hacer mas claro la secuencia y metodos}
